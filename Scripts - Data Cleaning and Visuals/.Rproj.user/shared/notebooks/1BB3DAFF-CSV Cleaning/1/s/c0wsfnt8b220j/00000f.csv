"0","# Calculate statistics using dplyr"
"0","summary_df <- all_comments %>%"
"0","  group_by(newsgroup) %>%"
"0","  summarize("
"0","    Threads = n_distinct(Thread.ID),"
"0","    Comments = n(),"
"0","    Authors = n_distinct(Author),"
"0","    Avg_Comments_Per_Thread = Comments / Threads,"
"0","    Avg_Sentiment_Score = mean(SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Add a totals row"
"0","totals <- summary_df %>%"
"0","  summarize("
"0","    newsgroup = ""Total"","
"0","    Threads = sum(Threads),"
"0","    Comments = sum(Comments),"
"0","    Authors = n_distinct(all_comments$Author),"
"0","    Avg_Comments_Per_Thread = sum(Comments) / sum(Threads),"
"0","    Avg_Sentiment_Score = mean(all_comments$SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Combine the summary with the totals row"
"0","summary_df <- bind_rows(summary_df, totals)"
"0",""
"0","# Print the summary data frame with totals"
"0","tab_df(summary_df, file = paste0(output_directory, ""images and tables/table_descriptive_statistics_full.html""))"
