"0","# Assign unique identifiers to newsgroups"
"0","newsgroup_ids <- c(""netmed"" = ""NG01"", ""netmotss"" = ""NG02"", ""netnews"" = ""NG03"","
"0","                   ""netpolitics"" = ""NG04"", ""netreligion"" = ""NG05"", ""netsingles"" = ""NG06"")"
"0",""
"0","# Update the all_threads dataset"
"0","all_threads <- all_threads %>%"
"0","  # Map newsgroup names to IDs and keep the original newsgroup column"
"0","  mutate(newsgroup_ID = factor(newsgroup, levels = names(newsgroup_ids), labels = newsgroup_ids),"
"0","         # Generate Unique Thread ID"
"0","         Unique_ThreadID = paste(newsgroup_ID, ThreadID, sep = ""_"")) %>%"
"0","  # Reorder columns: Unique_ThreadID, newsgroup, newsgroup_ID, followed by the rest"
"0","  select(Unique_ThreadID, newsgroup, newsgroup_ID, everything()) %>%"
"0","  # Rename ThreadID to NG_Relative_ThreadID"
"0","  rename(NG_Relative_ThreadID = ThreadID)"
"0",""
"0","# Update the all_comments dataset"
"0","all_comments <- all_comments %>%"
"0","  # Map newsgroup names to IDs and keep the original newsgroup column"
"0","  mutate(newsgroup_ID = factor(newsgroup, levels = names(newsgroup_ids), labels = newsgroup_ids),"
"0","         # Generate Unique Comment ID"
"0","         Unique_CommentID = paste(newsgroup_ID, Unique.Comment.ID, sep = ""_""),"
"0","         # Retain old Unique.Comment.ID as NG_Relative_CommentID"
"0","         NG_Relative_CommentID = Unique.Comment.ID,"
"0","         # Retain old Thread.ID as NG_Relative_ThreadID"
"0","         NG_Relative_ThreadID = Thread.ID, "
"0","         # Generate new newsgroup.thread.id"
"0","         Thread.ID = paste(newsgroup_ID, Thread.ID, sep = ""_""),"
"0","         # Retain old Comment.ID as Thread_Relative_CommentID"
"0","         Thread_Relative_CommentID = Comment.ID) %>%"
"0","  # Reorder columns: Unique_CommentID, newsgroup, newsgroup_ID, followed by the rest"
"0","  select(Unique_CommentID, newsgroup, newsgroup_ID, Thread.ID, NG_Relative_CommentID, NG_Relative_ThreadID, Thread_Relative_CommentID, everything()) %>%"
"0","  # Drop the old Unique.Comment.ID and Comment.ID columns"
"0","  select(-Unique.Comment.ID, -Comment.ID)"
"0",""
"0","# Function to clean the datetime strings"
"0","clean_datetime <- function(dt_str) {"
"0","  gsub(""[^[:alnum:] [:punct:]]"", """", dt_str)"
"0","}"
"0",""
"0","# Clean the Date.and.Time column"
"0","all_comments$Date.and.Time <- sapply(all_comments$Date.and.Time, clean_datetime)"
"0",""
"0","# Convert the cleaned Date.and.Time to POSIXct"
"0","all_comments$Date.and.Time <- as.POSIXct(all_comments$Date.and.Time, format = ""%b %d, %Y, %I:%M:%S%p"")"
"0",""
"0","all_comments$Hour <- as.numeric(format(all_comments$Date.and.Time, ""%H""))"
"0","all_comments$Date <- as.Date(all_comments$Date.and.Time)"
"0",""
"0","all_threads$Date <- as.Date(all_threads$Date, format = ""%m/%d/%y"")"
"0",""
"0","# Display the updated dataframes (optional)"
"0","head(all_threads)"
