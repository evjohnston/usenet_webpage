"0",""
"0","# Filter the all_comments dataset to only include posts by the top 15 influential authors"
"0","top_authors_comments <- filtered_comments %>%"
"0","  filter(Author %in% top_influential_authors$Author)"
"0",""
"0","# Assuming `top_authors_comments` already filters the dataset for top influential authors"
"0","top_authors_comments_summary <- top_authors_comments %>%"
"0","  group_by(Author) %>%"
"0","  summarize("
"0","    Num_Comments = n(),  # Number of comments"
"0","    Num_Threads = n_distinct(Thread.ID),  # Number of unique threads"
"0","    Threads_Started = sum(Thread_Relative_CommentID == ""CM00004"", na.rm = TRUE),  # Number of threads started"
"0","    Avg_Sentiment = mean(SentimentScore, na.rm = TRUE),  # Average sentiment score"
"0","    Avg_Relevancy = mean(Relevancy, na.rm = TRUE)  # Average relevancy score"
"0","  )"
"0",""
"0","# Merge this summary with the original `top_influential_authors` dataframe if needed"
"0","influential_authors_metadata <- top_influential_authors %>%"
"0","  left_join(top_authors_comments_summary, by = ""Author"")"
"0",""
"0",""
"0","# Calculate totals for each numeric column"
"0","totals_row <- influential_authors_metadata %>%"
"0","  summarize("
"0","    Author = ""Total"","
"0","    Influence = sum(Influence, na.rm = TRUE),"
"0","    Num_Comments = sum(Num_Comments, na.rm = TRUE),"
"0","    Num_Threads = sum(Num_Threads, na.rm = TRUE),"
"0","    Threads_Started = sum(Threads_Started, na.rm = TRUE),"
"0","    Avg_Sentiment = mean(Avg_Sentiment, na.rm = TRUE),  # This is an average; sum might not make sense for sentiment"
"0","    Avg_Relevancy = mean(Avg_Relevancy, na.rm = TRUE)   # This is an average; sum might not make sense for relevancy"
"0","  )"
"0",""
"0","# Bind the totals row to the bottom of the dataframe"
"0","influential_authors_metadata_with_totals <- bind_rows(influential_authors_metadata, totals_row)"
"0",""
"0","# Display the updated table with totals"
"0","print(influential_authors_metadata_with_totals)"
