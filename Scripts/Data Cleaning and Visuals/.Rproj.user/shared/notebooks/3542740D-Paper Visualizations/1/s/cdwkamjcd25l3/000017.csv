"0","# Ensure necessary libraries are loaded"
"0","library(ggplot2)"
"0","library(dplyr)"
"0",""
"0","# Convert Date columns to Date type"
"0","filtered_comments$Date <- as.Date(filtered_comments$Date)"
"0","usenet_comments_all$Date <- as.Date(usenet_comments_all$Date)"
"0",""
"0","# Calculate monthly average sentiment scores for AIDS-related discussions"
"0","monthly_sentiment_aids <- filtered_comments %>%"
"0","  group_by(Month = as.Date(format(Date, ""%Y-%m-01""))) %>%"
"0","  summarize(AverageSentiment = mean(SentimentScore, na.rm = TRUE))"
"0",""
"0","# Calculate monthly average sentiment scores for the entire Usenet dataset"
"0","monthly_sentiment_usenet <- usenet_comments_all %>%"
"0","  group_by(Month = as.Date(format(Date, ""%Y-%m-01""))) %>%"
"0","  summarize(AverageSentiment = mean(SentimentScore, na.rm = TRUE))"
"0",""
"0","# Filter the all_comments dataset to only include posts by the top 15 influential authors"
"0","top_authors_comments <- filtered_comments %>%"
"0","  filter(Author %in% top_influential_authors$Author)"
"0",""
"0","# Calculate monthly average sentiment scores for the influential authors"
"0","monthly_sentiment_influential <- top_authors_comments %>%"
"0","  group_by(Month = as.Date(format(Date, ""%Y-%m-01""))) %>%"
"0","  summarize(AverageSentiment = mean(SentimentScore, na.rm = TRUE))"
"0",""
"0","# Combine the datasets for plotting"
"0","combined_monthly_sentiment <- bind_rows("
"0","  monthly_sentiment_usenet %>% mutate(Dataset = ""Dataset One""),"
"0","  monthly_sentiment_aids %>% mutate(Dataset = ""Dataset Three""),"
"0","  monthly_sentiment_influential %>% mutate(Dataset = ""Influential Authors"")"
"0",")"
"0",""
"0","# Create the time series plot with a white background and no legend title"
"0","time_series_plot <- ggplot(combined_monthly_sentiment, aes(x = Month, y = AverageSentiment, color = Dataset)) +"
"0","  geom_line(size = 1.2) + "
"0","  labs("
"0","    title = ""Time Series of Average Sentiment Scores Over Time"","
"0","    x = ""Month"","
"0","    y = ""Average Sentiment Score"""
"0","  ) +"
"0","  theme_bw() +  # Use theme_bw() for a white background"
"0","  theme(legend.position = ""bottom"") +"
"0","  guides(color = guide_legend(title = NULL))  # Remove the legend title"
"2","Warning:"
"2"," [38;5;232mUsing `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
[36mâ„¹[38;5;232m Please use `linewidth` instead.
[90mThis warning is displayed once every 8 hours.[38;5;232m
[90mCall `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.[38;5;232m[39m
"
"0","# Add key event annotations"
"0","key_events <- data.frame("
"0","  date = as.Date(c(""1982-05-11"", ""1983-09-30"", ""1984-04-23"", ""1984-10-01"", "
"0","                   ""1985-03-02"", ""1985-07-25"", ""1985-10-02"", ""1986-02-01"", "
"0","                   ""1986-08-14"")),  # Add the key event dates"
"0","  event = c(""Term 'AIDS' Introduced"", ""CDC AIDS Guidelines"", ""HHS HIV/AIDS"", "
"0","            ""First HIV Blood Test"", ""First HIV Test Approved"", ""Rock Hudson's Diagnosis"", "
"0","            ""HIV Transmission Routes"", ""'HIV' Renamed"", ""AZT Approved""),  # Shorter descriptions"
"0","  y = c(-25, -25, -25, -25, -25, -25, -25, -25, -25)  # Set y position for text labels"
"0",")"
"0",""
"0","# Adding the annotations to the plot"
"0","time_series_plot <- time_series_plot +"
"0","  geom_vline(data = key_events, aes(xintercept = date), linetype = ""dashed"", alpha = 0.5) +  # Vertical dashed lines"
"0","  geom_text(data = key_events, aes(x = date, y = y, label = event), "
"0","            size = 3, angle = 90, vjust = -0.5, hjust = 0, inherit.aes = FALSE)  # Event labels"
"0",""
"0","# Print the plot to the R console"
"0","print(time_series_plot)"
