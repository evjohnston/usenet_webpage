"0","# Load necessary libraries"
"0","library(ggplot2)"
"0","library(dplyr)"
"0",""
"0","# Calculate the total number of comments per author across all newsgroups"
"0","total_comments_by_author <- filtered_comments %>%"
"0","  group_by(Author) %>%"
"0","  summarise(Total_Comments = n())"
"0",""
"0","# Calculate the number of comments per author per newsgroup"
"0","top_authors_by_newsgroup <- filtered_comments %>%"
"0","  group_by(Author, newsgroup) %>%"
"0","  summarise(Number_of_Comments = n())"
"1","[38;5;232m`summarise()` has grouped output by 'Author'. You can override using the `.groups` argument.[39m
"
"0","# Join the total comments data to the newsgroup data"
"0","top_authors_by_newsgroup <- top_authors_by_newsgroup %>%"
"0","  left_join(total_comments_by_author, by = ""Author"")"
"0",""
"0","# Select the top 15 most active authors by total number of comments"
"0","top_15_authors <- total_comments_by_author %>%"
"0","  arrange(desc(Total_Comments)) %>%"
"0","  slice(1:15)  # Ensure only the top 25 authors are selected"
"0",""
"0","# Filter the main data to include only the top 25 authors"
"0","top_15_data <- top_authors_by_newsgroup %>%"
"0","  filter(Author %in% top_15_authors$Author)"
"0",""
"0","# Create the bar plot using ggplot2 and sort authors in descending order by total number of comments"
"0","bar_plot <- ggplot(top_15_data, aes(x = Number_of_Comments, y = reorder(Author, Total_Comments), fill = newsgroup)) +"
"0","  geom_bar(stat = ""identity"") +"
"0","  labs(title = ""Top 15 Most Active Users in Dataset Three by Newsgroup"","
"0","       x = ""Number of Comments"","
"0","       y = ""Author"","
"0","       fill = ""Newsgroup"") +"
"0","  theme_bw() +"
"0","  theme(legend.position = ""right"","
"0","        axis.text.x = element_text(angle = 45, hjust = 1))"
"0",""
"0","# Print the plot"
"0","print(bar_plot)"
