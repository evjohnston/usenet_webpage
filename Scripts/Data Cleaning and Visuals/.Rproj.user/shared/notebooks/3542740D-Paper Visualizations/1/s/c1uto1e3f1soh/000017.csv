"0","# Load required libraries"
"0","library(tidyr)"
"0","library(dplyr)"
"0","library(sjPlot)"
"0",""
"0","# Visualize the top terms for each topic (concise visualization)"
"0","top_terms_df <- tidy(lda_model, matrix = ""beta"") %>%"
"0","  group_by(topic) %>%"
"0","  top_n(20, beta) %>%"
"0","  ungroup() %>%"
"0","  arrange(topic, -beta)"
"0",""
"0","# Round beta values to 3 decimal places"
"0","top_terms_df <- top_terms_df %>%"
"0","  mutate(beta = round(beta, 3))"
"0",""
"0","# Reshape the data frame to have each topic's terms and betas side by side"
"0","reshaped_df <- top_terms_df %>%"
"0","  group_by(topic) %>%"
"0","  mutate(term_id = row_number()) %>%"
"0","  ungroup() %>%"
"0","  pivot_wider("
"0","    names_from = topic,"
"0","    values_from = c(term, beta),"
"0","    names_glue = ""Topic_{topic}_{.value}"""
"0","  )"
"0",""
"0","reshaped_df <- reshaped_df %>%"
"0","  select(term_id, "
"0","         starts_with(""Topic_1_term""), starts_with(""Topic_1_beta""),"
"0","         starts_with(""Topic_2_term""), starts_with(""Topic_2_beta""),"
"0","         starts_with(""Topic_3_term""), starts_with(""Topic_3_beta""),"
"0","         starts_with(""Topic_4_term""), starts_with(""Topic_4_beta""),"
"0","         starts_with(""Topic_5_term""), starts_with(""Topic_5_beta""),"
"0","         starts_with(""Topic_6_term""), starts_with(""Topic_6_beta""))"
"0",""
"0","library(dplyr)"
"0","library(gt)"
"0",""
"0","# Create the gt table"
"0","gt_table <- reshaped_df %>%"
"0","  gt() %>%"
"0","  tab_spanner(label = ""Topic 1"", columns = c(""Topic_1_term"", ""Topic_1_beta"")) %>%"
"0","  tab_spanner(label = ""Topic 2"", columns = c(""Topic_2_term"", ""Topic_2_beta"")) %>%"
"0","  tab_spanner(label = ""Topic 3"", columns = c(""Topic_3_term"", ""Topic_3_beta"")) %>%"
"0","  tab_spanner(label = ""Topic 4"", columns = c(""Topic_4_term"", ""Topic_4_beta"")) %>%"
"0","  tab_spanner(label = ""Topic 5"", columns = c(""Topic_5_term"", ""Topic_5_beta"")) %>%"
"0","  tab_spanner(label = ""Topic 6"", columns = c(""Topic_6_term"", ""Topic_6_beta"")) %>%"
"0","  cols_label("
"0","    term_id = ""Term No."","
"0","    Topic_1_term = ""term"", Topic_1_beta = ""beta"", "
"0","    Topic_2_term = ""term"", Topic_2_beta = ""beta"","
"0","    Topic_3_term = ""term"", Topic_3_beta = ""beta"", "
"0","    Topic_4_term = ""term"", Topic_4_beta = ""beta"","
"0","    Topic_5_term = ""term"", Topic_5_beta = ""beta"", "
"0","    Topic_6_term = ""term"", Topic_6_beta = ""beta"")"
"0",""
"0","gt_table"
