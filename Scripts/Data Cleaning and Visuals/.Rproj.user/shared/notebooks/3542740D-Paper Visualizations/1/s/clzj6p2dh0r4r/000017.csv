"0","library(tidytext)"
"0","library(tidyverse)"
"0",""
"0","# Identify top keywords for influential authors"
"0","influential_keywords <- top_authors_comments %>%"
"0","  unnest_tokens(word, Full.Text) %>%"
"0","  anti_join(stop_words) %>%"
"0","  count(Author, word, sort = TRUE) %>%"
"0","  group_by(Author) %>%"
"0","  top_n(5, n) %>%"
"0","  ungroup()"
"1","[38;5;232mJoining with `by = join_by(word)`[39m
"
"0","# Get the top 20 keywords across all influential authors"
"0","top_keywords <- influential_keywords %>%"
"0","  group_by(word) %>%"
"0","  summarise(total = sum(n)) %>%"
"0","  top_n(20, total) %>%"
"0","  pull(word)"
"0",""
"0","# Function to calculate keyword prevalence"
"0","calculate_keyword_prevalence <- function(df, keywords) {"
"0","  df %>%"
"0","    unnest_tokens(word, Full.Text) %>%"
"0","    filter(word %in% keywords) %>%"
"0","    count(Date = floor_date(Date, ""month""), word) %>%"
"0","    complete(Date, word, fill = list(n = 0)) %>%"
"0","    group_by(Date) %>%"
"0","    mutate(prevalence = n / sum(n)) %>%"
"0","    ungroup()"
"0","}"
"0",""
"0","# Calculate keyword prevalence for influential authors and overall discussions"
"0","influential_prevalence <- calculate_keyword_prevalence(top_authors_comments, top_keywords)"
"0","overall_prevalence <- calculate_keyword_prevalence(filtered_comments, top_keywords)"
"0",""
"0","# Combine the data"
"0","combined_prevalence <- bind_rows("
"0","  influential_prevalence %>% mutate(group = ""Influential Authors""),"
"0","  overall_prevalence %>% mutate(group = ""Overall Discussion"")"
"0",")"
"0",""
"0","# Create the plot"
"0","keyword_adoption_plot <- ggplot(combined_prevalence, aes(x = Date, y = prevalence, color = group)) +"
"0","  geom_line() +"
"0","  facet_wrap(~word, scales = ""free_y"", ncol = 4) +"
"0","  labs(title = ""Keyword Adoption Over Time: Influential Authors vs Overall Discussion"","
"0","       x = ""Date"","
"0","       y = ""Keyword Prevalence"","
"0","       color = ""Group"") +"
"0","  theme_bw() +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1),"
"0","        legend.position = ""bottom"")"
"0",""
"0","# Print the plot"
"0","print(keyword_adoption_plot)"
