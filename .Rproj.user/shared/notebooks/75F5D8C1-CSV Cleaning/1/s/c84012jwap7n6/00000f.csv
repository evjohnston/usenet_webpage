"0","dataset2_stats <- relevant_comments %>%"
"0","  group_by(newsgroup) %>%"
"0","  summarize("
"0","    Threads = n_distinct(TH_ID),"
"0","    Comments = n(),"
"0","    Authors = n_distinct(Author),"
"0","    Avg_Comments_Per_Thread = Comments / Threads,"
"0","    Avg_Sentiment_Score = mean(SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Add a totals row"
"0","dataset2_totals <- dataset2_stats %>%"
"0","  summarize("
"0","    newsgroup = ""Total"","
"0","    Threads = sum(Threads),"
"0","    Comments = sum(Comments),"
"0","    Authors = n_distinct(relevant_comments$Author),"
"0","    Avg_Comments_Per_Thread = sum(Comments) / sum(Threads),"
"0","    Avg_Sentiment_Score = mean(relevant_comments$SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","dataset2_stats <- bind_rows(dataset2_stats, dataset2_totals)"
"0",""
"0","# Save as HTML or CSV"
"0","tab_df(dataset2_stats, file = file.path(output_directory, ""Images and Tables/Tables/dataset2_statistics.html""))"
