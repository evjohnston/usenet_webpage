"0","# Load required libraries"
"0","library(dplyr)"
"0","library(igraph)"
"0",""
"0","# Step 1: Filter comments in the top 16th percentile threads"
"0","# Ensure `filtered_relevant_comments` only includes comments from top 16th percentile threads"
"0","filtered_relevant_comments <- filtered_relevant_comments %>%"
"0","  filter(Thread.ID %in% filtered_relevant_threads$Unique_ThreadID)"
"0",""
"0","# Step 2: Create an author co-participation network"
"0","author_pairs <- filtered_relevant_comments %>%"
"0","  filter(!is.na(Thread.ID)) %>%"
"0","  group_by(Thread.ID) %>%"
"0","  summarise("
"0","    Pairs = list(if (length(unique(Author)) > 1) {"
"0","      as.data.frame(t(combn(unique(Author), 2)))"
"0","    } else {"
"0","      NULL"
"0","    })"
"0","  ) %>%"
"0","  unnest(Pairs, keep_empty = TRUE) %>%"
"0","  rename(Author1 = V1, Author2 = V2) %>%"
"0","  count(Author1, Author2, name = ""Weight"") %>%"
"0","  filter(!is.na(Author1) & !is.na(Author2))"
"0",""
"0","# Step 3: Create a graph from the author pairs"
"0","author_network <- graph_from_data_frame(author_pairs, directed = FALSE)"
"0",""
"0","# Step 4: Identify influential authors using degree centrality"
"0","degree_centrality <- strength(author_network, mode = ""all"", weights = E(author_network)$Weight)"
"0",""
"0","# Create a data frame of authors and their influence scores"
"0","influential_authors <- data.frame("
"0","  Author = names(degree_centrality),"
"0","  InfluenceScore = degree_centrality"
"0",") %>%"
"0","  arrange(desc(InfluenceScore)) %>%"
"0","  head(20) # Select the top 20 influential authors"
"0",""
"0","# Save the list of influential authors"
"0","write.csv(influential_authors, file.path(output_directory, ""/CSV Files/influential_authors.csv""), row.names = FALSE)"
"0",""
"0","# Print the top influential authors"
"0","print(influential_authors)"
