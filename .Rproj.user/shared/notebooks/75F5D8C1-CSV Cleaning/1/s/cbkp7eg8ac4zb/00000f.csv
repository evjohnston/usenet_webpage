"0","library(dplyr)"
"0","library(sjPlot)"
"0",""
"0","# Compute statistics grouped by newsgroup"
"0","descriptive_stats <- all_comments_in_influential_threads %>%"
"0","  group_by(newsgroup) %>%"
"0","  summarise("
"0","    Threads = n_distinct(NG_TH_ID),  # Total threads"
"0","    Total_Comments = n(),  # Total comments"
"0","    Influential_Authors_Comments = sum(Author %in% influential_author_comments$Author),  # Influential authors' comments"
"0","    Total_Authors = n_distinct(Author),  # Total unique authors"
"0","    Influential_Authors = n_distinct(Author[Author %in% influential_author_comments$Author]),  # Unique influential authors"
"0","    Average_Comments_Per_Thread = n() / n_distinct(NG_TH_ID),  # Avg comments per thread"
"0","    Avg_Total_Comments_Sentiment_Score = mean(SentimentScore, na.rm = TRUE),  # Avg sentiment for all comments"
"0","    Avg_Influential_Comments_Sentiment_Score = mean(SentimentScore[Author %in% influential_author_comments$Author], na.rm = TRUE)  # Avg sentiment for influential comments"
"0","  )"
"0",""
"0","# Add a totals row"
"0","totals_row <- descriptive_stats %>%"
"0","  summarise("
"0","    newsgroup = ""Total"","
"0","    Threads = sum(Threads),"
"0","    Total_Comments = sum(Total_Comments),"
"0","    Influential_Authors_Comments = sum(Influential_Authors_Comments),"
"0","    Total_Authors = n_distinct(all_comments_in_influential_threads$Author),"
"0","    Influential_Authors = n_distinct(influential_author_comments$Author),"
"0","    Average_Comments_Per_Thread = sum(Total_Comments) / sum(Threads),"
"0","    Avg_Total_Comments_Sentiment_Score = mean(all_comments_in_influential_threads$SentimentScore, na.rm = TRUE),"
"0","    Avg_Influential_Comments_Sentiment_Score = mean(influential_author_comments$SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Combine newsgroup stats with totals row"
"0","descriptive_stats <- bind_rows(descriptive_stats, totals_row)"
"0",""
"0","# Save and display the table"
"0","tab_df(descriptive_stats, file = file.path(output_directory, ""Images and Tables/Tables/dataset3_statistics.html""))"
