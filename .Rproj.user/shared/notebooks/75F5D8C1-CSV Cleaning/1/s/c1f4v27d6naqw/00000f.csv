"0","library(sjPlot)"
"0",""
"0","# Dataset 1: All Comments"
"0","dataset1_summary <- all_comments %>%"
"0","  group_by(newsgroup) %>%"
"0","  summarize("
"0","    Threads = n_distinct(TH_ID),"
"0","    Comments = n(),"
"0","    Authors = n_distinct(Author),"
"0","    Avg_Comments_Per_Thread = Comments / Threads,"
"0","    Avg_Sentiment_Score = mean(SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Add a totals row"
"0","dataset1_totals <- dataset1_summary %>%"
"0","  summarize("
"0","    newsgroup = ""Total"","
"0","    Threads = sum(Threads),"
"0","    Comments = sum(Comments),"
"0","    Authors = n_distinct(all_comments$Author),"
"0","    Avg_Comments_Per_Thread = sum(Comments) / sum(Threads),"
"0","    Avg_Sentiment_Score = mean(all_comments$SentimentScore, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Combine the summary with the totals row"
"0","dataset1_summary <- bind_rows(dataset1_summary, dataset1_totals)"
"0",""
"0","# Save or print the summary"
"0","tab_df(dataset1_summary, file = file.path(output_directory, ""Images and Tables/Tables/dataset1_statistics.html""))"
