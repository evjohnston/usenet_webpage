"0","dataset3_stats <- filtered_relevant_comments %>%"
"0","  group_by(newsgroup) %>%"
"0","  summarize("
"0","    Related_Comments = n(),"
"0","    Related_Threads = n_distinct(Thread.ID),"
"0","    Total_Comments_in_Related_Threads = sum(n()),"
"0","    Unique_Authors_in_Related_Threads = n_distinct(Author),"
"0","    Percent_Comments_with_Keyword = mean(Relevancy > 0) * 100,"
"0","    Avg_Comment_Relevancy = mean(Relevancy, na.rm = TRUE),"
"0","    Avg_Thread_Relevancy = mean(filtered_relevant_threads$ThreadRelevancyScore[filtered_relevant_threads$newsgroup == first(newsgroup)], na.rm = TRUE)"
"0","  )"
"0",""
"0","# Add a totals row"
"0","dataset3_totals <- dataset3_stats %>%"
"0","  summarize("
"0","    newsgroup = ""Total"","
"0","    Related_Comments = sum(Related_Comments),"
"0","    Related_Threads = sum(Related_Threads),"
"0","    Total_Comments_in_Related_Threads = sum(Total_Comments_in_Related_Threads),"
"0","    Unique_Authors_in_Related_Threads = n_distinct(filtered_relevant_comments$Author),"
"0","    Percent_Comments_with_Keyword = mean(Percent_Comments_with_Keyword),"
"0","    Avg_Comment_Relevancy = mean(Avg_Comment_Relevancy),"
"0","    Avg_Thread_Relevancy = mean(Avg_Thread_Relevancy)"
"0","  )"
"0",""
"0","dataset3_stats <- bind_rows(dataset3_stats, dataset3_totals)"
"0",""
"0","# Save as HTML or CSV"
"0","tab_df(dataset3_stats, file = paste0(output_directory, ""/Images and Tables/Tables/dataset3_statistics.html""))"
