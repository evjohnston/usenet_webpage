"0","library(dplyr)"
"0",""
"0","# Generate descriptive statistics for Dataset 4"
"0","dataset4_stats <- all_comments_in_influential_threads %>%"
"0","  group_by(newsgroup) %>%"
"0","  summarize("
"0","    Unique_Threads = n_distinct(Thread.ID),  # Unique threads with influential authors"
"0","    Total_Comments_All = n(),  # Total comments in relevant threads"
"0","    Influential_Comments = sum(Author %in% influential_authors$Author),  # Comments by influential authors"
"0","    Non_Influential_Comments = Total_Comments_All - Influential_Comments,  # Comments by non-influential authors"
"0","    Avg_Comment_Relevancy_All = mean(Relevancy, na.rm = TRUE),  # Avg relevancy for all comments"
"0","    Avg_Comment_Relevancy_Influential = mean(Relevancy[Author %in% influential_authors$Author], na.rm = TRUE),  # Avg relevancy for influential authors"
"0","    Avg_Comment_Relevancy_Non_Influential = mean(Relevancy[!(Author %in% influential_authors$Author)], na.rm = TRUE),  # Avg relevancy for non-influential authors"
"0","    Percent_Comments_With_Keyword_All = mean(Relevancy > 0) * 100,  # Percent of all comments with keyword"
"0","    Percent_Comments_With_Keyword_Influential = mean(Relevancy[Author %in% influential_authors$Author] > 0) * 100,  # Percent of influential comments with keyword"
"0","    Percent_Comments_With_Keyword_Non_Influential = mean(Relevancy[!(Author %in% influential_authors$Author)] > 0) * 100,  # Percent of non-influential comments with keyword"
"0","    Unique_Authors_in_Threads = n_distinct(Author),  # Unique authors in threads"
"0","    Avg_Thread_Relevancy = mean(influential_threads$ThreadRelevancyScore[influential_threads$threads$newsgroup == first(newsgroup)], na.rm = TRUE)  # Average thread relevancy"
"0","  )"
"0",""
"0","# Add a totals row for all newsgroups combined"
"0","dataset4_totals <- dataset4_stats %>%"
"0","  summarize("
"0","    newsgroup = ""Total"","
"0","    Unique_Threads = sum(Unique_Threads),"
"0","    Total_Comments_All = sum(Total_Comments_All),"
"0","    Influential_Comments = sum(Influential_Comments),"
"0","    Non_Influential_Comments = sum(Non_Influential_Comments),"
"0","    Avg_Comment_Relevancy_All = mean(Avg_Comment_Relevancy_All, na.rm = TRUE),"
"0","    Avg_Comment_Relevancy_Influential = mean(Avg_Comment_Relevancy_Influential, na.rm = TRUE),"
"0","    Avg_Comment_Relevancy_Non_Influential = mean(Avg_Comment_Relevancy_Non_Influential, na.rm = TRUE),"
"0","    Percent_Comments_With_Keyword_All = mean(Percent_Comments_With_Keyword_All, na.rm = TRUE),"
"0","    Percent_Comments_With_Keyword_Influential = mean(Percent_Comments_With_Keyword_Influential, na.rm = TRUE),"
"0","    Percent_Comments_With_Keyword_Non_Influential = mean(Percent_Comments_With_Keyword_Non_Influential, na.rm = TRUE),"
"0","    Unique_Authors_in_Threads = sum(Unique_Authors_in_Threads),"
"0","    Avg_Thread_Relevancy = mean(Avg_Thread_Relevancy, na.rm = TRUE)"
"0","  )"
"0",""
"0","# Combine statistics and totals"
"0","dataset4_stats <- bind_rows(dataset4_stats, dataset4_totals)"
"0",""
"0","# Save or display the table"
"0","tab_df(dataset4_stats, file = paste0(output_directory, ""/Images and Tables/Tables/dataset4_statistics.html""))"
"0",""
"0","# Print the table"
"0","print(dataset4_stats)"
